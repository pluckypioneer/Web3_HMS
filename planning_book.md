# 医院管理系统开发规划书（基于 Solidity、Vue、Flask 技术栈）

## 一、项目概述

### 1.1 项目目标

构建一套**融合区块链技术**的医院管理系统（HMS），实现医疗数据不可篡改存证、全流程数字化管理、多角色协同办公，同时满足医疗数据隐私保护与合规性要求。系统需覆盖患者服务、临床诊疗、运营管理等核心场景，通过区块链提升数据可信度，通过前后端分离架构保证用户体验与系统扩展性。

### 1.2 技术栈选型

| 技术领域       | 核心技术 / 框架                             | 选型理由                                                     |
| -------------- | ------------------------------------------- | ------------------------------------------------------------ |
| 前端开发       | Vue 3（Composition API）、Vue Router、Pinia | 组件化开发效率高，Pinia 实现状态管理，适配复杂表单与多角色权限控制 |
| 前端 UI / 样式 | Element Plus、CSS3、Less                    | 医疗系统需专业严谨的 UI，Element Plus 提供丰富表单 / 表格组件，Less 便于样式复用 |
| 后端开发       | Flask、Flask-RESTful、SQLAlchemy            | 轻量级框架适合快速开发 API，SQLAlchemy 简化数据库操作，支持多数据库适配 |
| 区块链层       | Solidity 0.8.x、Web3.js                     | Solidity 用于编写医疗数据存证智能合约，Web3.js 实现前端与区块链交互 |
| 数据库         | PostgreSQL（主数据）、Redis（缓存）         | PostgreSQL 支持复杂事务与医疗数据结构，Redis 提升高频访问接口性能（如候诊队列） |
| 文件存储       | IPFS（医疗影像 / 大文件）                   | 分布式存储适合医疗影像等大文件，与区块链哈希关联确保不可篡改 |
| 部署与运维     | Docker、Nginx、Jenkins                      | 容器化部署保证环境一致性，Nginx 实现负载均衡，Jenkins 支持 CI/CD |

## 二、系统架构设计

### 2.1 整体架构（分层设计）

plaintext











```plaintext
用户层（多端适配）
├─ 患者端（Web/移动端H5）
├─ 医护端（Web）
├─ 管理端（Web）
└─ 系统运维端（Web）

前端层（Vue 3 + Element Plus）
├─ 公共组件库（医疗专用组件：病历表单、药品选择器等）
├─ 路由管理（基于角色的动态路由）
├─ 状态管理（Pinia：用户信息、全局配置、区块链连接状态）
└─ API封装（Axios + 拦截器：请求加密、响应处理）

API网关层（Flask）
├─ 身份认证（JWT + 区块链地址验证）
├─ 权限控制（RBAC模型）
├─ 请求限流与日志
└─ 跨域处理

业务逻辑层（Flask服务）
├─ 患者服务模块
├─ 临床诊疗模块
├─ 住院管理模块
├─ 药品物资模块
├─ 运营管理模块
└─ 统计分析模块

数据层
├─ 关系型数据库（PostgreSQL）：业务数据（用户、订单、医嘱等）
├─ 缓存（Redis）：会话、高频数据（候诊队列、实时床位）
├─ 区块链（智能合约）：医疗数据哈希存证（病历、检查报告）
└─ 分布式存储（IPFS）：原始医疗影像、大文件病历
```

### 2.2 区块链层设计（核心创新点）

- **智能合约功能**：
  - `MedicalRecordHash.sol`：存储电子病历、检查报告的哈希值，记录修改历史（修改者地址、时间戳）
  - `AccessControl.sol`：管理医疗数据访问权限（患者授权医护人员查看的区块链记录）
  - `DrugTrace.sol`：高值耗材（如心脏支架）的溯源合约（生产厂家、流通记录、患者使用关联）
- **数据流转机制**：
  1. 关键医疗数据（如出院小结）生成后，前端计算 SHA-256 哈希
  2. 哈希通过后端 API 提交至智能合约，写入区块链（链上仅存哈希，不存原始数据）
  3. 原始数据存储于 IPFS，返回 CID（内容标识符）关联至 PostgreSQL
  4. 数据验证时，通过区块链哈希与原始数据哈希比对，确保未被篡改

## 三、核心功能模块设计

### 3.1 患者服务模块

| 功能点           | 前端实现                         | 后端接口                        | 区块链集成                     |
| ---------------- | -------------------------------- | ------------------------------- | ------------------------------ |
| 多渠道预约挂号   | 预约日历组件、科室筛选表单       | `POST /api/appointment`         | -                              |
| 电子就诊卡管理   | 卡片展示、信息编辑页             | `GET /api/patient/card`         | 就诊卡 ID 与区块链地址绑定     |
| 病历查询（本人） | 时间线展示、PDF 导出             | `GET /api/patient/records`      | 验证病历哈希（确保数据未篡改） |
| 医保结算         | 费用明细弹窗、支付集成           | `POST /api/payment/medical-ins` | -                              |
| 检查报告查看     | 报告列表、影像预览（集成 DICOM） | `GET /api/patient/reports`      | 报告哈希存证，支持完整性校验   |

### 3.2 临床诊疗模块

| 功能点         | 前端实现                       | 后端接口                  | 区块链集成                            |
| -------------- | ------------------------------ | ------------------------- | ------------------------------------- |
| 电子病历录入   | 结构化表单（支持模板复用）     | `POST /api/emr`           | 提交病历哈希至`MedicalRecordHash`合约 |
| 医嘱管理       | 医嘱列表、执行状态标签         | `POST /api/doctor/orders` | -                                     |
| 处方开具与审核 | 药品选择器、配伍禁忌提示       | `POST /api/prescription`  | 处方哈希存证（防篡改）                |
| 检查检验申请   | 检查项目多选组件、预约时间选择 | `POST /api/examination`   | -                                     |
| 手术麻醉管理   | 手术排程日历、麻醉记录表单     | `POST /api/surgery`       | 手术记录哈希存证                      |

### 3.3 住院管理模块

| 功能点           | 前端实现                     | 后端接口                       | 区块链集成                   |
| ---------------- | ---------------------------- | ------------------------------ | ---------------------------- |
| 床位分配与管理   | 床位状态可视化（三维病房图） | `PUT /api/inpatient/bed`       | -                            |
| 住院费用实时核算 | 费用明细表格、预警提示       | `GET /api/inpatient/fee`       | -                            |
| 出院结算         | 结算单生成、多支付方式集成   | `POST /api/inpatient/checkout` | 结算单哈希存证（医保审计用） |
| 护理计划与记录   | 护理时间轴、移动护理适配     | `POST /api/nursing/records`    | -                            |

### 3.4 药品与物资模块

| 功能点         | 前端实现               | 后端接口                  | 区块链集成                      |
| -------------- | ---------------------- | ------------------------- | ------------------------------- |
| 药品库存管理   | 库存预警图表、入库表单 | `POST /api/drug/stock`    | -                               |
| 高值耗材溯源   | 溯源信息链状展示       | `GET /api/supplies/trace` | 调用`DrugTrace`合约查询流通记录 |
| 耗材领用与核销 | 领用申请表单、扫码核销 | `POST /api/supplies/use`  | 绑定患者 ID 与耗材 ID 至区块链  |

### 3.5 系统管理模块

| 功能点         | 前端实现                   | 后端接口                    | 区块链集成                     |
| -------------- | -------------------------- | --------------------------- | ------------------------------ |
| 角色与权限管理 | 权限树组件、角色配置表单   | `PUT /api/admin/permission` | 管理员操作哈希存证（审计追踪） |
| 区块链节点管理 | 节点状态监控、连接配置     | `GET /api/blockchain/nodes` | -                              |
| 数据备份与恢复 | 备份任务调度、恢复操作日志 | `POST /api/admin/backup`    | -                              |

## 四、数据库设计（核心表结构）

### 4.1 核心业务表

| 表名           | 主要字段                                                     | 存储内容                           |
| -------------- | ------------------------------------------------------------ | ---------------------------------- |
| `patients`     | id, name, id_card, blockchain_addr, medical_card_id          | 患者基本信息（关联区块链地址）     |
| `doctors`      | id, name, dept_id, title, license_no, blockchain_addr        | 医生信息（执业证号、区块链地址）   |
| `emr_records`  | id, patient_id, doctor_id, content, ipfs_cid, blockchain_tx_hash, create_time | 电子病历（关联 IPFS 与区块链哈希） |
| `appointments` | id, patient_id, doctor_id, dept_id, schedule_time, status    | 预约挂号记录                       |
| `inpatients`   | id, patient_id, bed_id, admit_time, diagnosis, status        | 住院信息                           |
| `drugs`        | id, name, spec, supplier, stock, min_stock, blockchain_trace_id | 药品信息（关联区块链溯源 ID）      |

### 4.2 区块链关联表

| 表名            | 主要字段                                                     | 作用                               |
| --------------- | ------------------------------------------------------------ | ---------------------------------- |
| `contracts`     | id, name, address, abi, deploy_time                          | 智能合约地址与 ABI（便于调用）     |
| `data_hashes`   | id, data_type, original_id, hash_value, tx_hash, block_number | 数据哈希与区块链交易关联           |
| `access_grants` | id, grantor_addr, grantee_addr, data_id, expire_time         | 数据访问授权记录（关联区块链地址） |

## 五、开发流程与里程碑

### 5.1 开发阶段划分（12 个月周期）

#### 阶段 1：需求分析与设计（1.5 个月）

- 输出详细需求文档（含用户故事、用例图）
- 完成数据库 schema 设计、API 接口文档（Swagger）
- 智能合约逻辑设计（含安全审计要点）
- 前端 UI/UX 设计（Figma 原型，含响应式适配）

#### 阶段 2：核心框架搭建（1.5 个月）

- 前端：Vue 3 项目初始化、路由 / 状态管理配置、公共组件开发
- 后端：Flask 项目结构搭建、数据库连接、认证授权模块开发
- 区块链：本地测试环境搭建（Hardhat）、基础合约开发（AccessControl）

#### 阶段 3：核心功能开发（6 个月）

- 患者服务模块（2 个月）：预约、病历查询、缴费
- 临床诊疗模块（2 个月）：EMR、医嘱、处方、检查检验
- 住院与药品模块（2 个月）：床位管理、费用结算、药品溯源

#### 阶段 4：集成测试与优化（2 个月）

- 单元测试（前端 Jest、后端 pytest、合约 Truffle Test）
- 集成测试（API 接口联调、区块链交互测试）
- 性能优化（SQL 索引优化、Redis 缓存策略、前端懒加载）
- 安全测试（渗透测试、合约漏洞扫描）

#### 阶段 5：部署与上线（1 个月）

- 生产环境部署（Docker 容器化、Nginx 配置）
- 区块链节点部署（测试网→主网切换）
- 数据迁移方案实施
- 运维监控系统搭建（Prometheus + Grafana）

### 5.2 关键里程碑

| 里程碑          | 交付物                     | 验收标准                               |
| --------------- | -------------------------- | -------------------------------------- |
| M1（第 1.5 月） | 设计文档与原型             | 需求覆盖率 100%，架构评审通过          |
| M2（第 3 月）   | 框架 demo（含区块链连接）  | 前端路由正常，后端认证通过，合约可调用 |
| M3（第 6 月）   | 患者服务模块上线测试环境   | 预约、缴费流程跑通，数据存证成功       |
| M4（第 9 月）   | 临床与住院模块上线测试环境 | 病历录入、床位分配、费用结算功能完整   |
| M5（第 12 月）  | 系统正式上线               | 核心功能可用率 99.9%，数据零丢失       |

## 六、安全与合规设计

### 6.1 数据安全措施

- **传输层**：全接口 HTTPS 加密，敏感接口（如病历查询）额外加 AES 加密
- **存储层**：患者敏感信息（身份证、病历内容）加密存储，密钥由患者授权管理
- **区块链安全**：智能合约上线前通过 Mythril、Slither 工具审计，避免重入、溢出等漏洞
- **访问控制**：基于 RBAC 模型，支持细粒度权限（如 “只能查看本科室患者病历”）

### 6.2 合规性保障

- **医疗数据合规**：符合《电子病历应用管理规范》《医疗机构数据安全管理规定》
- **隐私保护**：遵循《个人信息保护法》，实现患者数据 “可查询、可更正、可删除”
- **区块链合规**：医疗数据哈希存证符合司法存证标准（对接法院区块链平台）

## 七、风险与应对措施

| 风险类型 | 具体风险                       | 应对措施                                    |
| -------- | ------------------------------ | ------------------------------------------- |
| 技术风险 | 区块链交易确认延迟影响用户体验 | 前端优化：显示 “存证中” 状态，异步通知结果  |
| 数据风险 | 医疗数据量大，IPFS 存储成本高  | 分级存储：核心数据存 IPFS，普通数据存云存储 |
| 团队风险 | Solidity 开发经验不足          | 提前开展培训，引入外部区块链顾问            |
| 合规风险 | 医疗数据上链合规性不明确       | 前期与卫健委沟通，仅存哈希不存原始数据      |

## 八、后期维护与扩展

### 8.1 维护计划

- 日常维护：服务器监控、日志分析、数据库备份（每日增量 + 每周全量）
- 定期更新：每月功能迭代、每季度安全补丁、每年区块链节点升级

### 8.2 扩展方向

- 对接医保电子凭证、电子健康卡等国家平台
- 引入 AI 辅助诊断（如影像识别），结果通过区块链存证
- 扩展移动端原生 APP（基于 Flutter），提升患者端体验

## 九、总结

本规划书基于 Solidity、Vue、Flask 技术栈，构建了一套融合区块链的医院管理系统，通过 “前端交互 - 后端服务 - 区块链存证” 三层架构，实现医疗数据的可信管理与高效流转。开发过程需严格遵循医疗行业规范，平衡技术创新与数据安全，最终交付一套 “体验优、安全高、可扩展” 的数字化医院管理解决方案。